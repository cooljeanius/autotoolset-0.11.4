<html lang="en">
<head>
<title>The Makefile standards - Developing software with GNU</title>
<meta http-equiv="Content-Type" content="text/html">
<meta name="description" content="Developing software with GNU">
<meta name="generator" content="makeinfo 4.13">
<link title="Top" rel="start" href="index.html#Top">
<link rel="up" href="Installing-GNU-software.html#Installing-GNU-software" title="Installing GNU software">
<link rel="prev" href="Installing-a-GNU-package.html#Installing-a-GNU-package" title="Installing a GNU package">
<link rel="next" href="Configuration-options.html#Configuration-options" title="Configuration options">
<link href="http://www.gnu.org/software/texinfo/" rel="generator-home" title="Texinfo Homepage">
<meta http-equiv="Content-Style-Type" content="text/css">
<style type="text/css"><!--
  pre.display { font-family:inherit }
  pre.format  { font-family:inherit }
  pre.smalldisplay { font-family:inherit; font-size:smaller }
  pre.smallformat  { font-family:inherit; font-size:smaller }
  pre.smallexample { font-size:smaller }
  pre.smalllisp    { font-size:smaller }
  span.sc    { font-variant:small-caps }
  span.roman { font-family:serif; font-weight:normal; } 
  span.sansserif { font-family:sans-serif; font-weight:normal; } 
--></style>
</head>
<body>
<div class="node">
<a name="The-Makefile-standards"></a>
<p>
Next:&nbsp;<a rel="next" accesskey="n" href="Configuration-options.html#Configuration-options">Configuration options</a>,
Previous:&nbsp;<a rel="previous" accesskey="p" href="Installing-a-GNU-package.html#Installing-a-GNU-package">Installing a GNU package</a>,
Up:&nbsp;<a rel="up" accesskey="u" href="Installing-GNU-software.html#Installing-GNU-software">Installing GNU software</a>
<hr>
</div>

<h3 class="section">1.2 The Makefile standards</h3>

<p>The <dfn>GNU coding standards</dfn> are a document that describes the requirements
that must be satisfied by all GNU programs. These requirements are driven
mainly by technical ocnsiderations, and they are excellent advice for
writing good software. The <dfn>makefile standards</dfn>, a part of the
GNU coding standards, require that your
makefiles do a lot more than simply compile and install the software.

   <p>One requirement is <dfn>cleaning targets</dfn>; these targets remove the files
that were generated while installing the package and restore the source
distribution to a previous state. There are three cleaning targets that
corresponds to three levels of cleaning: <code>clean</code>, <code>distclean</code>,
<code>maintainer-clean</code>.
     <dl>
<dt><code>clean</code><dd>Cleans up all the files that were generated by <code>make</code> and
<code>make check</code>, but not the files that were generated by running
<code>configure</code>. This targets cleans the build, but does not undo the
source configuration by the configure script. 
<br><dt><code>distclean</code><dd>Cleans up all the files generated by <code>make</code> and <code>make check</code>,
but also cleans the files that were generated by running <code>configure</code>. 
As a result, you can not invoke any other make targets until you run
the configure script again. This target reverts your source directory tree
back to the state in which it was when you first unpacked it. 
<br><dt><code>maintainer-clean</code><dd>Cleans up all the files that <code>distclean</code> cleans. However it also removes
files that the developers have automatically generated with the GNU build
system. Because users shouldn't need the entire GNU build system to install
a package, these files should not be removed in the final source distribution. 
However, it is occasionally useful for the maintainer to remove and
regenerate these files. 
</dl>

   <p>Another type of cleaning that is required is erasing the package itself from
the installation directory; <dfn>uninstalling</dfn> the package. To uninstall
the package, you must call
<pre class="example">     % make uninstall
</pre>
   <p class="noindent">from the toplevel directory of the source distribution. This will work only
if the source distribution is configured first. It will work best only
if you do it from the same source distribution, with the same configuration,
that you've used to install the package in the first place.

   <p>When you install GNU software, archive the source code to all the packages
that you install in a directory like <samp><span class="file">/usr/src</span></samp> or <samp><span class="file">/usr/local/src</span></samp>. 
To do that, first run <code>make clean</code> on the source distribution, and then
use a recursive copy to copy it to <samp><span class="file">/usr/src</span></samp>. The presense of a
source distribution in one of these directories should be a signal to you
that the corresponding package is currently installed.

   <p>Francois Pinard came up with a cute rule for remembering what the cleaning
targets do:
     <ul>
<li>If <code>configure</code> or <code>make</code> did it, <code>make distclean</code> undoes it. 
<li>If <code>make</code> did it, <code>make clean</code> undoes it. 
<li>If <code>make install</code> did it, <code>make uninstall</code> undoes it. 
<li>If <em>you</em> did it, <code>make maintainer-clean</code> undoes it. 
</ul>

   <p>GNU standard compliant makefiles also have a target for generating <dfn>tags</dfn>. 
Tags are files, called <samp><span class="file">TAGS</span></samp>, that are used by GNU Emacs to allow
you to navigate your source distribution more efficiently. 
More specifically, Emacs uses tags to take you from a place where a C function
is being used in a file, to the file and line number where the function is
defined. To generate the tags call:
<pre class="example">     % make tags
</pre>
   <p class="noindent">Tags are particularly useful when you are not the original author of the
code you are working on, and you haven't yet memorized where everything is. 
See <a href="Navigating-source-code.html#Navigating-source-code">Navigating source code</a>, for all the details about navigating large
source code trees with Emacs.

   <p>Finally, in the spirit of free redistributable code, there must be targets for
cutting a source code distribution. If you type
<pre class="example">     % make dist
</pre>
   <p class="noindent">it will rebuild the <samp><span class="file">foo-1.0.tar.gz</span></samp> file that you started with. 
If you modified the source, the modifications will be included in the
distribution (and you should probably change the version number). 
Before putting a distribution up on FTP, you can test its integrity
with:
<pre class="example">     % make distcheck
</pre>
   <p class="noindent">This makes the distribution, then unpacks it in a temporary subdirectory
and tries to configure it, build it, run the test-suite, and check if the
installation script works. If everything is okey then you're told that
your distribution is ready.

   <p>Writing reliable makefiles that support all of these targets is a very
difficult undertaking. This is why we prefer to generate our makefiles
instead with GNU Automake.

<!--  -->
   </body></html>

